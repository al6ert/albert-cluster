# infra/apps/traefik/values.yaml
# Valores base para Traefik v3.x

##########################
# CONFIGURACIÓN GLOBAL
##########################
global:
  domain: "example.com"

providers:
  kubernetesCRD:
    allowCrossNamespace: true        # Para middleware centralizado

##########################
# DASHBOARD
##########################
ingressRoute:
  dashboard:
    enabled: true
    entryPoints: ["websecure"]
    # Dominio se inyectará desde la capa env
    matchRule: >
      Host(`traefik.example.com`)
      && (PathPrefix(`/dashboard`) || PathPrefix(`/api`))
    tls:
      # secretName viene por overlay; aquí un placeholder
      secretName: ""

##########################
# CONFIGURACIÓN DE SERVICIOS
##########################
service:
  type: LoadBalancer

persistence:
  enabled: false
  path: /data
  size: 128Mi

additionalArguments:
  - "--certificatesresolvers.le.acme.httpchallenge=true"
  - "--certificatesresolvers.le.acme.httpchallenge.entrypoint=web"
  - "--certificatesresolvers.le.acme.email=albert@albertperez.dev"
  - "--certificatesresolvers.le.acme.storage=/data/acme.json"
  - "--certificatesresolvers.le.acme.caserver=https://acme-staging-v02.api.letsencrypt.org/directory" 