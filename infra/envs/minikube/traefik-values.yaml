# infra/envs/minikube/traefik-values.yaml
# Overrides específicos para tu entorno Minikube (desarrollo local)

global:
  domain: "127.0.0.1.nip.io"

ingressRoute:
  dashboard:
    matchRule: >
      Host(`traefik.127.0.0.1.nip.io`)
      && (PathPrefix(`/dashboard`) || PathPrefix(`/api`))
      

extraObjects:
  # Middleware de autenticación básica (referencia al secreto creado en bootstrap)
  - apiVersion: traefik.io/v1alpha1
    kind: Middleware
    metadata:
      name: basic-auth
      namespace: admin
    spec:
      basicAuth:
        secret: admin-basic-auth
        realm: "Protected Area"
  # Certificado wildcard para el entorno local
  - apiVersion: cert-manager.io/v1
    kind: Certificate
    metadata:
      name: wildcard-minikube
    spec:
      secretName: wildcard-minikube-tls
      dnsNames:
        - '*.127.0.0.1.nip.io'
      issuerRef:
        name: local-ca-issuer
        kind: ClusterIssuer      

tlsStore:
  default:
    defaultCertificate:
      secretName: "wildcard-minikube-tls"        